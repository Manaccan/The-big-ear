<!-- Keep only ONE copy of the modal in your HTML -->
<div id="docModal" class="doc-modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeDocModal()">&times;</span>
        <h2 id="modalTitle">Download Document</h2>
        <form id="docRequestForm" action="https://formspree.io/f/YOUR_FORMSPREE_ID" method="POST">
            <input type="hidden" name="document_type" id="docType">
            
            <div class="form-group">
                <label>Your Full Name</label>
                <input type="text" name="name" required class="form-input">
            </div>
            
            <div class="form-group">
                <label>Your Email</label>
                <input type="email" name="email" required class="form-input">
            </div>

            <button type="submit" class="submit-btn">
                <span class="spinner" style="display: none;">‚è≥</span>
                Send Document
            </button>
        </form>
    </div>
</div>

<script>
    // Document Request System - Only one copy needed
    const DOCUMENT_LINKS = {
        about: 'https://manaccan.github.io/the-big-ear/documents/about-us.pdf',
        professionals: 'https://manaccan.github.io/the-big-ear/documents/professionals-guide.pdf',
        investors: 'https://manaccan.github.io/the-big-ear/documents/investor-prospectus.pdf'
    };

    function showDocForm(docType) {
        const titles = {
            about: "About Us Overview",
            professionals: "Professional Partnerships Guide",
            investors: "Investor Prospectus"
        };
        
        if (!DOCUMENT_LINKS[docType]) {
            alert('Document not available. Please try again later.');
            return;
        }
        
        document.getElementById('docType').value = docType;
        document.getElementById('modalTitle').textContent = titles[docType];
        document.getElementById('docModal').style.display = 'block';
    }

    function closeDocModal() {
        document.getElementById('docModal').style.display = 'none';
    }

    // Form submission handler
    document.getElementById('docRequestForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const form = e.target;
        const spinner = form.querySelector('.spinner');
        const submitBtn = form.querySelector('button');
        
        try {
            spinner.style.display = 'inline-block';
            submitBtn.disabled = true;

            // Submit to Formspree
            await fetch(form.action, {
                method: 'POST',
                body: new FormData(form),
                headers: { 'Accept': 'application/json' }
            });

            // Direct download
            const docType = document.getElementById('docType').value;
            window.open(DOCUMENT_LINKS[docType], '_blank');
            
            closeDocModal();
            form.reset();

        } catch (error) {
            alert('Error: Please email us directly at hello@thebigear.org');
        } finally {
            spinner.style.display = 'none';
            submitBtn.disabled = false;
        }
    });

    // Close modal when clicking outside
    window.onclick = (event) => {
        if (event.target === document.getElementById('docModal')) {
            closeDocModal();
        }
    };
</script>
